# æŠ–éŸ³WebåŠ©æ‰‹ (Douyin Web Assistant)

è¿™æ˜¯ä¸€ä¸ªåŸºäºWebçš„æŠ–éŸ³è‡ªåŠ¨åŒ–å·¥å…·ï¼Œæ—¨åœ¨ç®€åŒ–å’Œè‡ªåŠ¨åŒ–å¸¸è§çš„æŠ–éŸ³ç½‘é¡µç‰ˆæ“ä½œï¼Œå¦‚æ‰¹é‡ç‚¹èµå’Œè¯„è®ºã€‚å®ƒé€šè¿‡ä¸€ä¸ªç®€æ´çš„Webç•Œé¢å’Œä¸€å¥—RESTful APIæ¥æ§åˆ¶ï¼Œå°†å¤æ‚çš„Seleniumæ“ä½œå°è£…åœ¨åå°æœåŠ¡ä¸­ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **Webç”¨æˆ·ç•Œé¢**: æä¾›ä¸€ä¸ªç®€å•çš„SPA (`index.html`)ï¼Œç”¨äºå‘èµ·ä»»åŠ¡ã€æŸ¥çœ‹çŠ¶æ€å’Œç®¡ç†è´¦æˆ·ã€‚
- **RESTful API**: è®¾è®¡æ¸…æ™°çš„APIç«¯ç‚¹ï¼Œæ–¹ä¾¿ä¸å…¶ä»–ç¨‹åºé›†æˆã€‚
- **åå°ä»»åŠ¡**: è‡ªåŠ¨åŒ–ä»»åŠ¡åœ¨ç‹¬ç«‹çš„åå°çº¿ç¨‹ä¸­è¿è¡Œï¼Œä¸ä¼šé˜»å¡APIæœåŠ¡ã€‚
- **çŠ¶æ€ç›‘æ§**: å¯éšæ—¶é€šè¿‡APIæŸ¥è¯¢å½“å‰è‡ªåŠ¨åŒ–ä»»åŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼ˆå¦‚ `è¿è¡Œä¸­`, `å·²å®Œæˆ`, `å¤±è´¥`ï¼‰ã€‚
- **å¤šè´¦æˆ·æ”¯æŒ**: é€šè¿‡åœ¨ `cookies/` ç›®å½•ä¸‹æ”¾ç½®ä¸åŒçš„Cookieæ–‡ä»¶æ¥è½»æ¾åˆ‡æ¢å’Œç®¡ç†å¤šä¸ªè´¦æˆ·ã€‚
- **æ™ºèƒ½æ“ä½œ**:
  - è‡ªåŠ¨ç‚¹èµå’Œè¯„è®ºæŒ‡å®šç”¨æˆ·ä¸»é¡µä¸‹çš„è§†é¢‘ã€‚
  - ä» `comments_pool.txt` æ–‡ä»¶ä¸­éšæœºé€‰æ‹©è¯„è®ºå†…å®¹ï¼Œæ¨¡æ‹ŸçœŸäººè¡Œä¸ºã€‚
  - å¯¹å·²å¤„ç†è¿‡çš„è§†é¢‘è¿›è¡Œè®°å½•ï¼Œé¿å…é‡å¤æ“ä½œã€‚
- **å¯æ‰©å±•æ€§**: æ¸…æ™°çš„åˆ†å±‚æ¶æ„ï¼ˆAPIã€æœåŠ¡ã€å‰ç«¯ï¼‰ï¼Œæ˜“äºæœªæ¥æ‰©å±•æ–°åŠŸèƒ½ã€‚

## ğŸ›ï¸ é¡¹ç›®æ¶æ„

é¡¹ç›®é‡‡ç”¨ç»å…¸çš„ä¸‰å±‚æ¶æ„ï¼Œå®ç°äº†å‰åç«¯åˆ†ç¦»ï¼š

1.  **å‰ç«¯ (Browser)**: ä¸€ä¸ªé™æ€çš„å•é¡µé¢åº”ç”¨ (`app/static/index.html`)ï¼Œä½¿ç”¨åŸç”ŸJavaScriptå’ŒFetch APIä¸åç«¯é€šä¿¡ã€‚
2.  **åç«¯ (Flask API Server)**: ä¸€ä¸ªPython Flaskåº”ç”¨ï¼Œæä¾›RESTful APIæ¥æ¥æ”¶å‰ç«¯æŒ‡ä»¤ï¼Œå¹¶ç®¡ç†è‡ªåŠ¨åŒ–ä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸã€‚
3.  **è‡ªåŠ¨åŒ–æœåŠ¡ (Selenium)**: æ ¸å¿ƒçš„è‡ªåŠ¨åŒ–é€»è¾‘ï¼Œä½¿ç”¨Seleniumåº“æ¥æ§åˆ¶ä¸€ä¸ªçœŸå®çš„æµè§ˆå™¨å®ä¾‹ï¼Œæ‰§è¡Œå…·ä½“çš„ç½‘é¡µæ“ä½œã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
douyin-web-assistant/
â”œâ”€â”€ app/                        # æ ¸å¿ƒåº”ç”¨ç›®å½•
â”‚   â”œâ”€â”€ api/                    # APIè“å›¾
â”‚   â”‚   â””â”€â”€ routes.py           # APIè·¯ç”±å®šä¹‰
â”‚   â”œâ”€â”€ services/               # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ automator.py        # å°è£…Seleniumè‡ªåŠ¨åŒ–é€»è¾‘
â”‚   â”œâ”€â”€ static/                 # å‰ç«¯æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ css/main.css
â”‚   â”‚   â”œâ”€â”€ js/main.js
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â””â”€â”€ __init__.py             # Flaskåº”ç”¨å·¥å‚
â”œâ”€â”€ cookies/                    # å­˜æ”¾ç”¨æˆ·Cookieæ–‡ä»¶
â”‚   â””â”€â”€ ä½ çš„è´¦æˆ·å1.json
â”‚   â””â”€â”€ ä½ çš„è´¦æˆ·å2.json
â”œâ”€â”€ tests/                      # Pytestæµ‹è¯•ç›®å½•
â”œâ”€â”€ comments_pool.txt           # è¯„è®ºæ± æ–‡ä»¶
â”œâ”€â”€ requirements.txt            # Pythonä¾èµ–
â”œâ”€â”€ run.py                      # åº”ç”¨å¯åŠ¨è„šæœ¬
â””â”€â”€ README.md                   # æœ¬æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

- å®‰è£… [Python 3.8+](https://www.python.org/downloads/)
- å®‰è£… [Google Chrome](https://www.google.com/chrome/) æµè§ˆå™¨
- å®‰è£… [ChromeDriver](https://googlechromelabs.github.io/chrome-for-testing/) å¹¶ç¡®ä¿å…¶è·¯å¾„åœ¨ç³»ç»Ÿçš„ `PATH` ç¯å¢ƒå˜é‡ä¸­ã€‚**é‡è¦æç¤º**: ChromeDriverçš„ç‰ˆæœ¬å¿…é¡»ä¸ä½ çš„Chromeæµè§ˆå™¨ç‰ˆæœ¬å®Œå…¨åŒ¹é…ã€‚

### 2. å®‰è£…

1.  **å…‹éš†ä»“åº“**
    ```bash
    git clone https://github.com/your-username/douyin-web-assistant.git
    cd douyin-web-assistant
    ```

2.  **å®‰è£…ä¾èµ–**
    ```bash
    pip install -r requirements.txt
    ```

### 3. é…ç½®

1.  **æ·»åŠ è´¦æˆ·Cookie**
    - åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `cookies` æ–‡ä»¶å¤¹ã€‚
    - ä½¿ç”¨æµè§ˆå™¨æ’ä»¶ï¼ˆå¦‚ [EditThisCookie](https://chromewebstore.google.com/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg)ï¼‰å¯¼å‡ºä½ ç™»å½•æŠ–éŸ³åçš„Cookieã€‚
    - å°†å¯¼å‡ºçš„Cookieä¿å­˜ä¸ºJSONæ ¼å¼çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶å‘½åä¸º `ä½ çš„è´¦æˆ·å.json`ï¼ˆä¾‹å¦‚ `my_account.json`ï¼‰ï¼Œç„¶åæ”¾å…¥ `cookies` æ–‡ä»¶å¤¹ã€‚
    - æ–‡ä»¶åï¼ˆä¸å«`.json`åç¼€ï¼‰å°†è¢«è§†ä¸ºè´¦æˆ·ååœ¨å‰ç«¯å±•ç¤ºã€‚

2.  **é…ç½®è¯„è®ºå†…å®¹**
    - ç¼–è¾‘æ ¹ç›®å½•ä¸‹çš„ `comments_pool.txt` æ–‡ä»¶ã€‚
    - æ¯è¡Œæ·»åŠ ä¸€æ¡ä½ å¸Œæœ›å‘å¸ƒçš„è¯„è®ºã€‚è„šæœ¬ä¼šè‡ªåŠ¨å¿½ç•¥ç©ºè¡Œå’Œä»¥ `#` å¼€å¤´çš„è¡Œã€‚

### 4. è¿è¡Œ

1.  **å¯åŠ¨åç«¯æœåŠ¡**
    ```bash
    python run.py
    ```
    æœåŠ¡å°†é»˜è®¤åœ¨ `http://127.0.0.1:5000` ä¸Šè¿è¡Œã€‚

2.  **æ‰“å¼€å‰ç«¯é¡µé¢**
    - åœ¨ä½ çš„æµè§ˆå™¨ä¸­ï¼Œç›´æ¥æ‰“å¼€ `app/static/index.html` æ–‡ä»¶ã€‚
    - ä½ ä¹Ÿå¯ä»¥é€šè¿‡è®¿é—® `http://127.0.0.1:5000/static/index.html` æ¥åŠ è½½é¡µé¢ã€‚

    > **æ³¨æ„**: æµè§ˆå™¨å¯èƒ½ä¼šæœ‰å®‰å…¨é™åˆ¶ï¼Œæ¨èé€šè¿‡è®¿é—®FlaskæœåŠ¡åœ°å€æ¥åŠ è½½é¡µé¢ï¼Œä»¥é¿å…æ½œåœ¨çš„CORSé—®é¢˜ã€‚

## ğŸ“‹ API æ¥å£è¯´æ˜

æ‰€æœ‰APIéƒ½ä»¥ `/api` ä¸ºå‰ç¼€ã€‚

#### `GET /api/status`
- **æè¿°**: è·å–å½“å‰è‡ªåŠ¨åŒ–ä»»åŠ¡çš„çŠ¶æ€ã€‚
- **å“åº”**:
  ```json
  {
    "code": 0, "message": "Success",
    "data": {
      "status": "idle" | "running" | "completed" | "failed" | "stopped",
      "log": "æœ€æ–°çš„æ—¥å¿—ä¿¡æ¯"
    }
  }
  ```

#### `GET /api/accounts`
- **æè¿°**: è·å– `cookies/` ç›®å½•ä¸‹æ‰€æœ‰å¯ç”¨çš„è´¦æˆ·åˆ—è¡¨ã€‚
- **å“åº”**:
  ```json
  {
    "code": 0, "message": "Success",
    "data": {
      "count": 2,
      "accounts": ["ä½ çš„è´¦æˆ·å1", "ä½ çš„è´¦æˆ·å2"]
    }
  }
  ```

#### `POST /api/run_task`
- **æè¿°**: å¯åŠ¨ä¸€ä¸ªæ–°çš„è‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚
- **è¯·æ±‚ä½“**:
  ```json
  {
    "urls": ["https://www.douyin.com/user/...", "https://www.douyin.com/user/..."],
    "account": "ä½ çš„è´¦æˆ·å1"
  }
  ```
- **å“åº” (202 Accepted)**:
  ```json
  { "code": 0, "message": "Task accepted and started in the background." }
  ```

#### `POST /api/stop_task`
- **æè¿°**: è¯·æ±‚åœæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ã€‚
- **å“åº”**:
  ```json
  { "code": 0, "message": "Stop signal sent. The task will terminate shortly." }
  ```

## ğŸ¤ å¦‚ä½•è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼è¯·éµå¾ªæ ‡å‡†çš„GitHub Flowï¼š

1.  ä¸ºä½ çš„åŠŸèƒ½æˆ–ä¿®å¤åˆ›å»ºä¸€ä¸ª [Issue](https://github.com/your-username/douyin-web-assistant/issues)ã€‚
2.  ä» `develop` åˆ†æ”¯åˆ›å»ºä¸€ä¸ªæ–°çš„ç‰¹æ€§åˆ†æ”¯ (`feature/<issue_no>-description`)ã€‚
3.  å®Œæˆå¼€å‘å’Œæµ‹è¯•åï¼Œæäº¤ä¸€ä¸ª [Pull Request](https://github.com/your-username/douyin-web-assistant/pulls) åˆ° `develop` åˆ†æ”¯ã€‚
4.  ç¡®ä¿ä½ çš„ä»£ç éµå¾ªé¡¹ç›®è§„èŒƒï¼Œå¹¶é€šè¿‡æ‰€æœ‰æµ‹è¯•ã€‚